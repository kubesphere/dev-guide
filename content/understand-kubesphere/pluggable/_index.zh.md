---
title: 可插拔
weight: 220
description: KubeSphere 可插拔架构介绍
---

## 背景

KubeSphere 发展至今，自诩为“面向云原生应用的分布式操作系统”，借助 Ansible、Shell Operator 和 Helm 等工具实现了基本的功能插拔。随着社区的发展、各种新功能的整合，KubeSphere 的代码仓库越来越臃肿，KubeSphere 逐渐演变成一个笨重的“巨石应用”。针对“巨石应用”，不管是开发维护还是测试部署无疑其效率是不高的，可扩展性也越来越低。为了解决这一矛盾，将“巨石”进行拆分变得势在必行。另外很重要的一点是我们也希望能够引入一种低成本的可扩展能力。为此，我们在 KubeSphere 4.0 中实现了一种全新的可插拔架构。

## 挑战

为了实现更为开放的可插拔架构，KubeSphere 在核心层面需要提供以下能力：
* 前端插件化：前端项目支持插件化，支持在各级导航栏插入新的功能入口，支持动态添加功能页面的。
* 后端插件化：后端支持 API 拓展机制，提供统一的 API 聚合能力，提供统一的认证鉴权机制。
* 插件管理：提供可视化的插件管理能力，支持插件的安装、卸载、启用、停用、配置、升级。
* 插件分发：提供插件分发管理机制，提供内置的插件中心。
* 插件开发：提供插件开发、打包、发布相关的规范文档与命令行工具，提供完善的插件开发文档。

## 整体架构
![可插拔架构图](/images/pluggable-arch/pluggable-arch.png)

如上图所示，可插拔架构包括前端部分和后端部分。两者都实现了“微内核+插件”的架构。并通过插件管理模块进行插件的加载、卸载等操作。其中内核部分仅包含如路由管理、插件管理等框架性的功能，业务功能全部放在插件中实现。具体前后端架构请点击以下链接：

* [前端架构设计](./frontend-pluggable-architecture)
* [后端架构设计](./backend-pluggable-architecture)

## 插件开发

插件按照形态进行划分：

1. 插件可以是包含前后端的单独的功能模块，如 “DMP(数据库管理平台)”。插件接入后可以挂载在某个菜单项上，比如顶部导航栏、侧边栏、工具栏等。
2. 插件可以是纯前端插件或纯后端插件，比如“css 主题”插件、“网关API增强”插件。

插件的开发流程和普通的应用开发大体类似，包括后端开发、前端开发、打包发布。需要注意的是，针对插件的发布与更新我们提供了 `ks-builder` 命令行工具。针对插件前端开发我们提供 `create-ks-app` 前端脚手架，方便开发者快速搭建项目初始化代码，并且提供 KubeDesign、ks-console/shared 等组件库、util 库为前端开发提供良好的基建支持。插件具体开发流程请看 [插件开发指南](../../plugin-develoment-guide)。

## 可插拔架构的优点

1. ks-core 与各插件功能解耦，变得更加轻量
2. 隔离插件故障，保障 ks-core 的稳定运行
3. 开放的架构，插件开发更自由
4. 插件独立开发，高内聚，代码更容易理解、开发上手难度低、效率更高
